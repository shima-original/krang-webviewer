<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Krang Dataset</title>
    <meta
      name="viewport"
      content="width = device - width, initial-scale = 1.0, shrink-to-fit = no"
    />

    <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"
    />
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>

    <script src="src/krang-dataset.js"></script>
    <link href="src/overview.css" rel="stylesheet" />

    <script>
      const cardTemplate = (data) => {
        const httpResponseStatus = 200,
          fileExists = httpResponseStatus === 200;

        const classes = {
          fileExistsIcon: fileExists ? "" : "hidden",
          noFileIcon: fileExists ? "hidden" : "",
        };

        return `
          <a
            href='deepzoom.html#${data.id}'
            class='preview-card'
            style='background-image: url(${data.url})'
          >
            <p class='slide-id'>${data.id}</p>

            <svg
              class="bi bi-bag-check-fill ${classes.fileExistsIcon}"
              xmlns="http://www.w3.org/2000/svg"
              width="16"
              height="16"
              fill="currentColor"
              viewBox="0 0 16 16"
            >
              <path
                fill-rule="evenodd"
                d="M10.5 3.5a2.5 2.5 0 0 0-5 0V4h5v-.5zm1 0V4H15v10a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V4h3.5v-.5a3.5 3.5 0 1 1 7 0zm-.646 5.354a.5.5 0 0 0-.708-.708L7.5 10.793 6.354 9.646a.5.5 0 1 0-.708.708l1.5 1.5a.5.5 0 0 0 .708 0l3-3z"
              />
            </svg>

            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="16"
              height="16"
              fill="currentColor"
              class="bi bi-bag-dash ${classes.noFileIcon}"
              viewBox="0 0 16 16"
            >
              <path
                fill-rule="evenodd"
                d="M5.5 10a.5.5 0 0 1 .5-.5h4a.5.5 0 0 1 0 1H6a.5.5 0 0 1-.5-.5z"
              />

              <path
                d="M8 1a2.5 2.5 0 0 1 2.5 2.5V4h-5v-.5A2.5 2.5 0 0 1 8 1zm3.5 3v-.5a3.5 3.5 0 1 0-7 0V4H1v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V4h-3.5zM2 5h12v9a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V5z"
              />
            </svg>
          </a>
        `;
      };

      $(document).ready(() => {
        const overviewRoot = $("#overview");

        krang_listPreviews().then((list) => {
          list.forEach((data) => overviewRoot.append(cardTemplate(data)));
        });
      });
    </script>
  </head>

  <body>
    <nav class="cuts"><a href="cuts.html">Cuts</a></nav>
    <div class="container">
      <h1>Сканы гистологических препаратов головного мозга</h1>

      <div id="overview"></div>
    </div>
    <!-- /container -->
  </body>
</html>
